

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>EventMQ Protocol Specification &mdash; EventMQ 0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="EventMQ 0 documentation" href="index.html"/>
        <link rel="up" title="Contributing to EventMQ" href="contributing.html"/>
        <link rel="prev" title="Contributing to EventMQ" href="contributing.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> EventMQ
          

          
          </a>

          
            
            
              <div class="version">
                0.3-rc8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="using.html">Using EventMQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="contributing.html">Contributing to EventMQ</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">EventMQ Protocol Specification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#goals">Goals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#license">License</a></li>
<li class="toctree-l3"><a class="reference internal" href="#language">Language</a></li>
<li class="toctree-l3"><a class="reference internal" href="#architecture">Architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#topology">Topology</a></li>
<li class="toctree-l4"><a class="reference internal" href="#router-addressing">ROUTER Addressing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#global-frames">Global Frames</a></li>
<li class="toctree-l4"><a class="reference internal" href="#emqp-client">eMQP / Client</a></li>
<li class="toctree-l4"><a class="reference internal" href="#emqp-scheduler">eMQP / Scheduler</a></li>
<li class="toctree-l4"><a class="reference internal" href="#emqp-worker">eMQP / Worker</a></li>
<li class="toctree-l4"><a class="reference internal" href="#emqp-publisher">eMQP / Publisher</a></li>
<li class="toctree-l4"><a class="reference internal" href="#heartbeating">Heartbeating</a></li>
<li class="toctree-l4"><a class="reference internal" href="#headers">Headers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#disconnect-and-kbai">DISCONNECT and KBAI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/enderlabs/eventmq">Source Code</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/enderlabs/eventmq/issues">Issues</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">EventMQ</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="contributing.html">Contributing to EventMQ</a> &raquo;</li>
      
    <li>EventMQ Protocol Specification</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/protocol.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="eventmq-protocol-specification">
<h1>EventMQ Protocol Specification<a class="headerlink" href="#eventmq-protocol-specification" title="Permalink to this headline">¶</a></h1>
<p><em>The status of this document is alpha and subject to heavy change</em></p>
<div class="section" id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a></h2>
<p>The EventMQ Protocol (eMQP) defines a reliable service-oriented request-reply and pub-sub dialog between a set of clients, a broker, and a set of workers.</p>
<p>The goals are to:</p>
<blockquote>
<div><ul class="simple">
<li>Specify a protocol to follow when implementing a component to EventMQ.</li>
<li>Allow requests to be routed to workers by an abstracted service name (named queues).</li>
<li>Detect disconnected peers through heartbeating.</li>
<li>Allow for message tracing and debugging.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>This Specification is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 2.1 of the License, or (at your option) any later version.</p>
<p>This Specification is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more details.</p>
</div>
<div class="section" id="language">
<h2>Language<a class="headerlink" href="#language" title="Permalink to this headline">¶</a></h2>
<p>The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in RFC 2119[[1](<a class="reference external" href="http://tools.ietf.org/html/rfc2119">http://tools.ietf.org/html/rfc2119</a>)].</p>
</div>
<div class="section" id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h2>
<p>insert pretty picture here</p>
<div class="section" id="topology">
<h3>Topology<a class="headerlink" href="#topology" title="Permalink to this headline">¶</a></h3>
<p>eMQP connects a set of client applications (e.g. web servers), a broker, and a pool of workers. Clients connect to the broker as well as the workers.</p>
<p>&#8216;Clients&#8217; is defined as application issuing requests and &#8216;workers&#8217; as applications that process these requests. (Workers consist of a <cite>JobManager</cite> and a pool of <cite>Worker</cite> resources where the job executes.)</p>
<p>The EventMQ broker handles a set of named queues. The broker SHOULD serve clients on a fair request and MAY deliver requests to workers on any basis, including 0MQ&#8217;s built-in round robin or least-recently used.</p>
</div>
<div class="section" id="router-addressing">
<h3>ROUTER Addressing<a class="headerlink" href="#router-addressing" title="Permalink to this headline">¶</a></h3>
<p>In the case of request-reply, the broker MUST use a ROUTER socket to accept requests from both clients and workers. The broker MAY use a seperate socket implementing a subset of eMQP, or MAY use a single socket implementing all of eMQP.</p>
<p>From the 0MQ manual[[2](<a class="reference external" href="http://api.zeromq.org/master:zmq-socket">http://api.zeromq.org/master:zmq-socket</a>)]
&gt; When receiving messages a ROUTER socket shall prepend a message part containing the identity of the originating peer to the message before passing it to the application. When sending messages a ROUTER socket shall remove the first part of the message and use it to determine the identity of the peer the message shall be routed to.</p>
<p>This extra frame is not shown in the specifications below.</p>
</div>
<div class="section" id="global-frames">
<h3>Global Frames<a class="headerlink" href="#global-frames" title="Permalink to this headline">¶</a></h3>
<p>An <strong>ACK</strong> command consists of a 4-frame multipart message, formatted as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="19%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>ACK</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
<tr class="row-even"><td>4</td>
<td>_MSGID_</td>
<td>The message id of the message this ACK is acknowledging</td>
</tr>
</tbody>
</table>
<p>A <strong>REPLY</strong> frame consists of a 5-frame multipart message, formatted as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="31%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>REPLY</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
<tr class="row-even"><td>4</td>
<td>_MSG_</td>
<td>The reply to respond with</td>
</tr>
</tbody>
</table>
<p>A <strong>HEARTBEAT</strong> frame consists of a</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="33%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>HEARTBEAT</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
<tr class="row-even"><td>4</td>
<td>_UNIX_TS_</td>
<td>A unix timestamp</td>
</tr>
</tbody>
</table>
<p>A <strong>DISCONNECT</strong> frame consists of</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="33%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>DISCONNECT</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
</tbody>
</table>
<p>A <strong>KBAI</strong> frame consists of</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="33%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>KBAI</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="emqp-client">
<h3>eMQP / Client<a class="headerlink" href="#emqp-client" title="Permalink to this headline">¶</a></h3>
<p>A <strong>REQUEST</strong> command consists of a 7-frame multipart message, formatted as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="20%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>REQUEST</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
<tr class="row-even"><td>4</td>
<td>_QUEUE_NAME_</td>
<td>the name of the queue the request should be sent to</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>_HEADERS_</td>
<td>dictionary of headers. can be an empty set</td>
</tr>
<tr class="row-even"><td>6</td>
<td>_MSG_</td>
<td>The message to send</td>
</tr>
</tbody>
</table>
<p>A <strong>PUBLISH</strong> command consists of a 7-frame multipart messag, formatted as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="17%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>PUBLISH</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
<tr class="row-even"><td>4</td>
<td>_TOPIC_NAME_</td>
<td>the name of the topic this message should be published across</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>_HEADERS_</td>
<td>csv list of headers</td>
</tr>
<tr class="row-even"><td>6</td>
<td>_MSG_</td>
<td>The message to send</td>
</tr>
</tbody>
</table>
<p>A <strong>SCHEDULE</strong> command consists of a 7-frame multipart message, formatted as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="23%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>SCHEDULE</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
<tr class="row-even"><td>4</td>
<td>_QUEUE_NAME_</td>
<td>name of queue that the job should run in</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>_HEADERS_</td>
<td>csv list of headers for this message</td>
</tr>
<tr class="row-even"><td>6</td>
<td>_MSG_</td>
<td>The message to send</td>
</tr>
</tbody>
</table>
<p>An <strong>UNSCHEDULE</strong> command consists of a 7-frame multipart message, formatted as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="20%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>UNSCHEDULE</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
<tr class="row-even"><td>4</td>
<td>_QUEUE_NAME_</td>
<td>ignored for this command, broadcasted to all queues</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>_HEADERS_</td>
<td>csv list of headers for this message</td>
</tr>
<tr class="row-even"><td>6</td>
<td>_MSG_</td>
<td>The message to send</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="emqp-scheduler">
<h3>eMQP / Scheduler<a class="headerlink" href="#emqp-scheduler" title="Permalink to this headline">¶</a></h3>
<p>An <strong>INFORM</strong> command consists of a 6-frame multipart message, formatted as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="29%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>INFORM</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
<tr class="row-even"><td>4</td>
<td>&nbsp;</td>
<td>Queues. Unused for scheduler</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>scheduler</td>
<td>type of peer connecting</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="emqp-worker">
<h3>eMQP / Worker<a class="headerlink" href="#emqp-worker" title="Permalink to this headline">¶</a></h3>
<p>An <strong>INFORM</strong> command consists of a 5-frame multipart message, formatted as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="13%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>INFORM</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
<tr class="row-even"><td>4</td>
<td>_QUEUES_</td>
<td>csv seperated arrays containing an int and a string for weight and name. e.g. [40, &#8216;email&#8217;]</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>worker</td>
<td>type of peer connecting</td>
</tr>
</tbody>
</table>
<p>A <strong>READY</strong> frame consists of a 4-frame multipart message, formatted as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="33%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>READY</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="emqp-publisher">
<h3>eMQP / Publisher<a class="headerlink" href="#emqp-publisher" title="Permalink to this headline">¶</a></h3>
<p>A <strong>PUBLISH</strong> frame consists of a 6-frame multipart message, formatted as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="33%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">FRAME</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>_EMPTY_</td>
<td>leave empty</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>eMQP/1.0</td>
<td>Protocol version</td>
</tr>
<tr class="row-even"><td>2</td>
<td>PUBLISH</td>
<td>command</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>_MSGID_</td>
<td>A unique id for the msg</td>
</tr>
<tr class="row-even"><td>4</td>
<td>TOPIC</td>
<td>A topic to publish to</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>MSG</td>
<td>Message to be published</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="heartbeating">
<h3>Heartbeating<a class="headerlink" href="#heartbeating" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li>HEARTBEAT commands are valid at any time after an INFORM command.</li>
<li>Any command except DISCONNECT act as a heartbeat. Peers SHOULD NOT send HEARTBEAT commands while sending other commands.</li>
<li>Worker and broker MUST send heartbeats at regular and agreed-upon intervals.</li>
<li>Scheduler and broker MUST send heartbeats at regular and agreed-upon intervals.</li>
<li>If the worker detects that the broker disconnected it SHOULD restart the conversation.</li>
<li>If the broker detects that a worker has disconnected it should stop sending it a message of any type.</li>
<li>If the scheduler detects that the broker disconnects it SHOULD restart the conversation.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="headers">
<h3>Headers<a class="headerlink" href="#headers" title="Permalink to this headline">¶</a></h3>
<p>Headers MUST be 0 to many comma seperated values inserted into the header field. If there are no headers required, an empty string MUST be sent where headers are required.</p>
<p>Below is a table which defines and describes the headers.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="3%" />
<col width="3%" />
<col width="4%" />
<col width="3%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Header</th>
<th class="head">REQUEST</th>
<th class="head">PUBLISH</th>
<th class="head">SCHEDULE</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>reply-requested</td>
<td>X</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>False</td>
<td>Once the job is finished, send a reply back with information from the job. If there is no information reply with a True value.</td>
</tr>
<tr class="row-odd"><td>retry-count:#</td>
<td>X</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>0</td>
<td>Retry a failed job this many times before accepting defeat.</td>
</tr>
<tr class="row-even"><td>timeout:#</td>
<td>X</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>0</td>
<td>Kill the job after X seconds, defaults to never timing out (0)</td>
</tr>
<tr class="row-odd"><td>guarantee</td>
<td>X</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>False</td>
<td>Ensure the job completes by letting someone else worry about a success reply.</td>
</tr>
<tr class="row-even"><td>nohaste</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>X</td>
<td>False</td>
<td>When scheduling a job, set this to True if you don&#8217;t want the job to run immediately as it&#8217;s scheduled.  Instead, it will run for the first time when the interval has elapsed.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="disconnect-and-kbai">
<h2>DISCONNECT and KBAI<a class="headerlink" href="#disconnect-and-kbai" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>When a component receives a DISCONNECT command it:</dt>
<dd><ul class="first last simple">
<li>MUST send a KBAI command to all connected components.</li>
<li>MUST stop sending and receiving any messages</li>
<li>MUST allow any pending messages or jobs to complete.</li>
</ul>
</dd>
<dt>When a component receives a KBAI command it:</dt>
<dd><ul class="first last simple">
<li>MUST stop sending any messages to the disconnecting component.</li>
<li>SHOULD Clean up references to the disconnecting component.</li>
</ul>
</dd>
</dl>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="contributing.html" class="btn btn-neutral" title="Contributing to EventMQ" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, EventMQ Contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>